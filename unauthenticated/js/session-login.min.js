try{const e=document.querySelector("html"),t="data-platform";if(navigator.userAgentData&&navigator.userAgentData.platform){const n=navigator.userAgentData.platform.toLowerCase();if(n.includes("linux")){e.setAttribute(t,"linux")}else if(n.includes("windows")){e.setAttribute(t,"windows")}else if(n.includes("mac")){e.setAttribute(t,"macos")}}else if(navigator.platform){const n=navigator.platform.toLowerCase();if(n.includes("linux")){e.setAttribute(t,"linux")}else if(n.includes("win")){e.setAttribute(t,"windows")}else if(n.includes("mac")){e.setAttribute(t,"macos")}}}catch(e){console.warn("Failed to detect platform:",e)}function theme_spinner(e,t,n){const r="cspinner_container";e=e?e:document.querySelector("button i.fa-sign-in:not(.invisible)")||document.querySelector("button i.fa-qrcode:not(.invisible)"),s='<span class="'+r+'"><span class="cspinner">'+'<span class="cspinner-icon white small"></span></span></span>';if(e&&!t){e.classList.add("invisible");e.insertAdjacentHTML("afterend",s);e.parentNode.classList.add("disabled");e.parentNode.disabled=true}else if(e&&t){e.classList.remove("invisible");e.parentNode.classList.remove("disabled");e.parentNode.disabled=false;const t=e.parentNode.querySelector("."+r);if(t){t.parentNode.removeChild(t)}if(n){e.className="fa2 fa2-marker-check";e.parentNode.classList.add("disabled")}}}function theme_content_loaded(){const e=typeof theme_language==="object"?theme_language:{},t=".container.session_login",n=".session_login_back.forgot",r=function(e,t){const n=(e?"faa-bounce animated":"faa-horizontal animated").split(" ");t.classList.add(...n);setTimeout(()=>{t.classList.remove(...n)},1500)};(function(){const e=document.querySelectorAll('input[type="password"]');e.forEach(e=>{const t=document.createElement("span");t.classList.add("input_warning_caps");t.setAttribute("title","Caps Lock");t.classList.add("large");e.classList.add("use_input_warning_caps");e.parentNode.insertBefore(t,e.nextSibling);e.addEventListener("blur",function(){this.nextSibling.classList.remove("visible")});e.addEventListener("keydown",function(e){if(typeof e.getModifierState==="function"){let t;if(e.keyCode===20){t=!e.getModifierState("CapsLock")}else{t=e.getModifierState("CapsLock")}if(t){this.nextSibling.classList.add("visible")}else{this.nextSibling.classList.remove("visible")}}})})})();(function(){const n=document.querySelector('[name="twofactor"]');if(n){const s=document.querySelector('[data-submit="2fa"]'),o=s.querySelector("i"),i=s.getAttribute("data-prefix"),a=location.origin+i,c=document.querySelector('[name="user"]'),l=document.querySelector('[name="pass"]'),u=document.querySelector('[name="save"]'),d=n.closest("form"),f=d.getAttribute("action")||url.toString(),p=function(s){s.preventDefault();theme_spinner(o);const i=new URLSearchParams;i.append("user",c.value);i.append("pass",l.value);if(u){i.append("save",u.checked?1:0)}i.append("twofactor",n.value);fetch(f,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i}).then(t=>{if(t.url){m=t.url}if(!t.ok){throw new Error(e.session_neterror)}return t.text()}).then(e=>{const n=new DOMParser,s=n.parseFromString(e,"text/html");const i=s.querySelector(t);if(i){theme_spinner(o,true);const e=document.querySelector(t),n=e.querySelectorAll(".alert");n.forEach(e=>e.remove());const i=s.querySelector(".alert");if(i){e.insertBefore(i.cloneNode(true),e.firstChild);r(false,e.querySelector(".alert"))}return}location.href=m}).catch(e=>{location.href=m})};let m=a;if(n){n.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(s)s.click();return false}})}d.addEventListener("submit",function(r){r.preventDefault();const o=new URLSearchParams;o.append("user",c.value);o.append("pass",l.value);if(u){o.append("save",u.checked?1:0)}o.append("twofprobe",1);fetch(f,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o}).then(t=>{if(t.url){m=t.url}if(t.status===401){return{needsTwoFactor:true}}else if(!t.ok){throw new Error(e.session_neterror)}else{return t.text().then(e=>{return{needsTwoFactor:false,htmlResponse:e}})}}).then(e=>{if(e.needsTwoFactor){const e=document.querySelector(".session_login_flipper");e.classList.toggle("flipped");e.classList.toggle("twofactor");const t=document.querySelector(".alert");if(t){t.remove()}setTimeout(()=>{n.focus()},600);s.removeEventListener("click",p);s.addEventListener("click",p);return}else{const n=e.htmlResponse,r=new DOMParser,s=r.parseFromString(n,"text/html");const o=document.querySelector(t),i=s.querySelector(t);if(o&&i){o.innerHTML=i.innerHTML;theme_content_loaded();setTimeout(()=>{document.querySelector('[name="pass"]').focus()});return}location.href=m}}).catch(e=>{console.warn("Request failed:",e);location.href=m})})}})();(function(){const s=document.querySelector(n+" .form-signin-group > .btn-success"),o=document.querySelectorAll(".session_login_flipper [data-flipper]"),i=document.querySelector(n+' input[name="forgot"]'),a=document.querySelector(n+" [data-unlocker]"),c=document.querySelector(n+' input[name="newpass"]'),l=document.querySelector(n+' input[name="newpass2"]'),u=t,d=function(e){let t=e.querySelector(".panel-body > [data-fatal-error-text]");if(!t||!t.textContent.trim()){t=e.querySelector(".panel-body > .err-content")}return t},f=function(t,n){let s=document.querySelector(u+" > .alert");if(s){s.remove()}s=document.createElement("div");s.className="alert";s.innerHTML=`\n                    <strong><i class="fa"></i> </strong><br>\n                    <span></span>`;const o=document.querySelector(u);if(o){o.insertBefore(s,o.firstChild)}s.classList.remove("alert-warning","alert-success","alert-danger");const i=s.querySelector(".fa"),a=s.querySelector("strong"),c=s.querySelector("span");if(t==="success"){r(true,s);s.classList.add("alert-success");if(i)i.className="fa fa-check-circle";if(a)a.innerHTML='<i class="fa fa-check-circle"></i> '+e.session_success;if(c)c.innerHTML=n}else{r(false,s);s.classList.add("alert-danger");if(i)i.className="fa fa-exclamation-circle";if(a)a.innerHTML='<i class="fa fa-exclamation-circle"></i> '+e.session_error;if(c)c.textContent=n}};if(o){o.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(".session_login_flipper"),n=t.classList.contains("forgot");!n&&t.classList.toggle("flipping",true);!n&&t.classList.toggle("forgot",true);setTimeout(()=>{n&&t.classList.toggle("flipping",false);n&&t.classList.toggle("forgot",false)},600);t.classList.toggle("flipped");const r=!t.classList.contains("flipped")?document.querySelector('input[name="user"]'):document.querySelector('input[name="forgot"]');if(r){setTimeout(()=>{r.focus()},600)}})})}if(i){i.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(s)s.click();return false}})}if(c){c.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(l)l.focus();return false}});if(l){l.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(a)a.click();return false}})}}if(s){s.addEventListener("click",function(t){t.preventDefault();if(this.classList.contains("disabled")){return}if(!i||!i.value.trim()){f("error",e.session_cannot);return}const n=i.value.trim(),r=this.querySelector("i");theme_spinner(r);fetch("forgot_send.cgi",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`forgot=${encodeURIComponent(n)}`}).then(t=>{if(t.url){serverRedirectUrl=t.url}if(!t.ok){throw new Error(e.session_neterror)}return t.text()}).then(t=>{const n=new DOMParser,s=n.parseFromString(t,"text/html");const o=s.querySelector(".panel-body > center");if(o&&o.textContent.trim()){theme_spinner(r,true,true);f("success",o.innerHTML.trim());return}theme_spinner(r,true);const i=d(s);if(i&&i.textContent.trim()){f("error",i.textContent.trim());return}f("error",e.session_unkerror)}).catch(t=>{theme_spinner(r,true);console.warn("Request failed:",t);f("error",e.session_conerror)})})}if(a){const t=document.querySelector(n),r=function(){t.remove();const e=new URL(window.location.href);e.search="";history.replaceState({},document.title,e);const n=document.querySelector(u+" .alert");if(n){n.remove()}};if(o.length>0){o[0].addEventListener("click",function(e){e.preventDefault();r()})}if(c){setTimeout(()=>{c.focus()},0)}a.addEventListener("click",function(n){n.preventDefault();if(this.classList.contains("disabled")){return}if(!c||!c.value.length){f("error",e.session_resetepassreq);return}if(!l||!l.value.length){f("error",e.session_pwdconf);return}const r=c.value;const s=l.value;if(r!==s){f("error",e.session_pwdmatch);return}const i=t?t.getAttribute("data-forgot"):null,a=t?t.getAttribute("data-username"):null;if(!i){f("error",e.session_noid);return}const u=this.querySelector("i");theme_spinner(u);fetch("forgot.cgi",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`id=${encodeURIComponent(i)}&newpass=${encodeURIComponent(r)}&newpass2=${encodeURIComponent(s)}`}).then(t=>{if(t.url){serverRedirectUrl=t.url}if(!t.ok){throw new Error(e.session_neterror)}return t.text()}).then(t=>{const n=new DOMParser,r=n.parseFromString(t,"text/html");const s=d(r);if(s&&s.textContent.trim()){theme_spinner(u,true);f("error",s.textContent.trim());return}theme_spinner(u,true,true);o[0].click();f("success",e.session_pwdsucc)}).catch(t=>{theme_spinner(u,true);console.warn("Request failed:",t);f("error",e.session_conerror)})})}})()}document.addEventListener("DOMContentLoaded",theme_content_loaded);